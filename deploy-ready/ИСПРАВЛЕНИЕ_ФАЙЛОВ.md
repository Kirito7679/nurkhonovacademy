# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —Ñ–∞–π–ª–∞–º–∏

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
**–°–∏–º–ø—Ç–æ–º—ã:** –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "ƒê¬£√ë‚Ç¨√ê¬≥√ê¬∞ 1" –≤–º–µ—Å—Ç–æ "–£—Ä–≥–∞ 1")

**–ü—Ä–∏—á–∏–Ω—ã:**
- Multer –ø–æ–ª—É—á–∞–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Content-Disposition
- –ò–º—è —Ñ–∞–π–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –ù–µ –±—ã–ª–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- **Backend:** –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î
  - –§–∞–π–ª: `backend/src/controllers/fileController.ts`
  - –ü—Ä–æ–±—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (decodeURIComponent, Buffer)
- **Frontend:** –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
  - –§–∞–π–ª: `frontend/src/pages/LessonView.tsx`
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Å–∫–∞–∂–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã

### 2. –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ —Ñ–∞–π–ª–∞
**–°–∏–º–ø—Ç–æ–º—ã:** –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–°–∫–∞—á–∞—Ç—å" —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ –±—ã–ª–æ `e.preventDefault()` –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ onClick
- –ù–µ –±—ã–ª–æ `e.stopPropagation()`
- –ù–µ –±—ã–ª–æ `type="button"` —É –∫–Ω–æ–ø–∫–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω `e.preventDefault()` –∏ `e.stopPropagation()` –≤ `handleDownload`
- –î–æ–±–∞–≤–ª–µ–Ω `type="button"` –∫ –∫–Ω–æ–ø–∫–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤ –∏–∑ –æ–±–ª–∞—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Backend –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```typescript
// –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
let decodedFileName = req.file.originalname;
try {
  if (req.file.originalname.includes('%') || /[^\x00-\x7F]/.test(req.file.originalname)) {
    decodedFileName = decodeURIComponent(req.file.originalname);
  }
} catch {
  // Fallback to Buffer decoding or original
}
```

### Frontend –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```typescript
// –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏
{(() => {
  try {
    if (file.fileName.includes('√ê') || file.fileName.includes('√ë')) {
      return decodeURIComponent(escape(file.fileName));
    }
    return file.fileName;
  } catch {
    return file.fileName;
  }
})()}

// –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
const handleDownload = async (e: React.MouseEvent, fileUrl: string, fileName: string) => {
  e.preventDefault();
  e.stopPropagation();
  // ... rest of download logic
}
```

---

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

1. **–û–±–Ω–æ–≤–∏—Ç—å –±—ç–∫–µ–Ω–¥:**
   - –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `backend/src/controllers/fileController.ts`
   - –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä

2. **–û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥:**
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏–∑ `deploy-ready/`
   - –°–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ `–û–ë–ù–û–í–õ–ï–ù–ò–ï_–§–†–û–ù–¢–ï–ù–î–ê.md`

---

## ‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ CSP –æ—à–∏–±–∫–∞—Ö Google Drive

CSP –æ—à–∏–±–∫–∏ —Å Google Drive - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. Google –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–≤–æ–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ iframe –Ω–∞ –¥—Ä—É–≥–∏—Ö –¥–æ–º–µ–Ω–∞—Ö. –≠—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ —Ñ–∞–π–ª
- –ó–∞–≥—Ä—É–∂–∞–π—Ç–µ –≤–∏–¥–µ–æ –Ω–∞–ø—Ä—è–º—É—é —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ YouTube –∏–ª–∏ Vimeo

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** $(date '+%Y-%m-%d %H:%M:%S')


