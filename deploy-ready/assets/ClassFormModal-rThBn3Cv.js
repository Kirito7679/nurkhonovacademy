import{r as f,V as N,k as h,j as e,X as y}from"./vendor-react-BjEyyFPN.js";import{t as S,o as w,s as m,e as k,n as F}from"./vendor-forms-DJ3QO7Zi.js";import{a as b}from"./index-DvAsZ7Fn.js";const E=w({name:m().min(1,"Название класса обязательно"),description:m().optional(),maxStudents:F().int().min(1).max(50).default(10),level:k(["Beginner","Intermediate","Advanced"]).optional(),language:m().optional()});function M({isOpen:g,onClose:c,onSuccess:u,classData:t}){const[x,a]=f.useState(""),{register:i,handleSubmit:j,formState:{errors:l},reset:p}=N({resolver:S(E),defaultValues:t?{name:t.name,description:t.description||"",maxStudents:t.maxStudents,level:t.level||void 0,language:t.language||""}:{name:"",description:"",maxStudents:10,level:void 0,language:""}}),d=h(async s=>(await b.post("/classes",s)).data.data,{onSuccess:()=>{p(),a(""),u()},onError:s=>{var n,r;a(((r=(n=s.response)==null?void 0:n.data)==null?void 0:r.message)||"Ошибка при создании класса")}}),o=h(async s=>(await b.put(`/classes/${t==null?void 0:t.id}`,s)).data.data,{onSuccess:()=>{p(),a(""),u()},onError:s=>{var n,r;a(((r=(n=s.response)==null?void 0:n.data)==null?void 0:r.message)||"Ошибка при обновлении класса")}}),v=s=>{a(""),t?o.mutate(s):d.mutate(s)};return g?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-neutral-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-900",children:t?"Редактировать класс":"Создать новый класс"}),e.jsx("button",{onClick:c,className:"text-neutral-400 hover:text-neutral-600 transition-colors",children:e.jsx(y,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:j(v),className:"p-6 space-y-6",children:[x&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:x}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Название класса *"}),e.jsx("input",{...i("name"),type:"text",id:"name",className:"input-field",placeholder:"Например: Английский для начинающих - Группа A"}),l.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Описание"}),e.jsx("textarea",{...i("description"),id:"description",rows:3,className:"input-field",placeholder:"Описание класса, цели обучения..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxStudents",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Максимум студентов *"}),e.jsx("input",{...i("maxStudents",{valueAsNumber:!0}),type:"number",id:"maxStudents",min:"1",max:"50",className:"input-field"}),l.maxStudents&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.maxStudents.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"level",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Уровень"}),e.jsxs("select",{...i("level"),id:"level",className:"input-field",children:[e.jsx("option",{value:"",children:"Не указан"}),e.jsx("option",{value:"Beginner",children:"Начинающий"}),e.jsx("option",{value:"Intermediate",children:"Средний"}),e.jsx("option",{value:"Advanced",children:"Продвинутый"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block text-sm font-medium text-neutral-700 mb-2",children:"Язык обучения"}),e.jsx("input",{...i("language"),type:"text",id:"language",className:"input-field",placeholder:"Например: English, Русский"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-neutral-200",children:[e.jsx("button",{type:"button",onClick:c,className:"btn-secondary",disabled:d.isLoading||o.isLoading,children:"Отмена"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:d.isLoading||o.isLoading,children:d.isLoading||o.isLoading?"Сохранение...":t?"Сохранить":"Создать"})]})]})]})}):null}export{M as C};
