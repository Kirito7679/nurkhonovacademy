# Функционал управления учителями

## Выполненные изменения

### 1. Переименование "Кураторы" в "Учителя" ✅

- Страница `/admin/curators` теперь называется "Учителя"
- Функционал создания кураторов изменен на создание учителей
- Учителя создаются с ролью `TEACHER` и автоматически получают `isPaidTeacher: true`

**Файлы:**
- `frontend/src/pages/Curators.tsx` - переименовано и обновлено
- `frontend/src/components/Sidebar.tsx` - обновлена метка меню
- `backend/src/controllers/curatorController.ts` - изменен на создание учителей

### 2. Права доступа учителей ✅

Учителя теперь имеют следующие права:

- ✅ **Создание студентов**: Учителя могут создавать студентов через интерфейс
- ✅ **Создание курсов**: Учителя могут создавать только свои курсы
- ✅ **Просмотр курсов**: Учителя видят только свои курсы (не видят курсы других учителей)
- ✅ **Создание классов**: Учителя могут создавать групповые классы (уже реализовано)
- ✅ **Назначение курсов**: Учителя могут назначать студентам только свои курсы

**Файлы:**
- `backend/src/controllers/studentController.ts` - обновлена логика создания и просмотра студентов
- `backend/src/controllers/courseController.ts` - права доступа уже настроены правильно
- `frontend/src/pages/Students.tsx` - добавлена кнопка создания студентов для учителей

### 3. Отслеживание создателя студента ✅

- Добавлено поле `createdBy` в модель `User`
- В списке студентов отображается информация о том, кто создал студента:
  - Если студент создан учителем/админом - показывается имя создателя и его роль
  - Если студент зарегистрировался самостоятельно - показывается "Самостоятельная регистрация"

**Файлы:**
- `backend/prisma/schema.prisma` - добавлено поле `createdBy` и отношение `creator`
- `backend/src/controllers/studentController.ts` - сохранение и возврат информации о создателе
- `frontend/src/types/index.ts` - обновлен тип `User`
- `frontend/src/pages/Students.tsx` - добавлена колонка "Создан" в таблицу

### 4. Улучшенная валидация ✅

- Добавлена валидация формата телефона для создания учителей и студентов
- Добавлена проверка сложности пароля
- Улучшены сообщения об ошибках

**Файлы:**
- `frontend/src/pages/Curators.tsx` - обновлена валидация
- `frontend/src/pages/Students.tsx` - обновлена валидация

## Миграция базы данных

⚠️ **ВАЖНО**: Необходимо применить миграцию для добавления поля `createdBy` в таблицу `users`.

См. файл `MIGRATION_INSTRUCTIONS.md` для подробных инструкций.

## Логика работы

### Создание учителей
- Только админ может создавать учителей
- Учителя автоматически получают `isPaidTeacher: true`
- Учителя могут сразу создавать курсы и студентов

### Создание студентов
- Админ и учителя могут создавать студентов
- При создании сохраняется `createdBy` (ID создателя)
- Учителя видят всех студентов, которых они создали, а также студентов, записанных на их курсы

### Просмотр курсов
- Учителя видят только свои курсы
- Админ видит все курсы
- Студенты видят видимые курсы и курсы, назначенные им

### Назначение курсов студентам
- Учителя могут назначать только свои курсы
- Админ может назначать любые курсы
- При назначении курса создается запись в `StudentCourse` со статусом `APPROVED`

## Тестирование

После применения миграции проверьте:

1. ✅ Админ может создавать учителей через `/admin/curators`
2. ✅ Учителя могут создавать студентов через `/teacher/students`
3. ✅ В списке студентов отображается информация о создателе
4. ✅ Учителя видят только свои курсы
5. ✅ Учителя могут назначать только свои курсы студентам

