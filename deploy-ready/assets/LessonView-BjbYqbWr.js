import{u as oe,r as L,e as P,V as ne,f as Q,j as e,S as me,M as ye,a5 as xe,an as ve,ao as we,T as de,C as Ce,h as fe,$ as le,a0 as Se,a1 as ke,ap as ue,aq as pe,D as V,ar as ie,z as Ee,k as Le,ag as Re,d as $e,as as Ae,at as Te,au as q,s as he,L as ee,aj as De,ak as Ie,aa as be}from"./vendor-D1Bc63Il.js";import{u as ge,c as Oe,R,C as je,a as E}from"./index-BcL9BEkO.js";import{a as Me,b as Ue}from"./courseUtils-Bo8LqfoL.js";const Pe=t=>{const i=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,r=t.match(i);return r&&r[2].length===11?r[2]:null},ze=t=>{const i=/(?:vimeo\.com\/|player\.vimeo\.com\/video\/)(\d+)/,r=t.match(i);return r?r[1]:null},_e=t=>{const i=/drive\.google\.com\/file\/d\/([a-zA-Z0-9_-]+)/,r=t.match(i);return r?r[1]:null},Ne=t=>{if(!t)return"other";const i=t.toLowerCase();return i.includes("youtube.com")||i.includes("youtu.be")?"youtube":i.includes("vimeo.com")?"vimeo":i.includes("drive.google.com")?"google-drive":i.includes("vk.com/video")?"vk":/\.(mp4|webm|ogg|mov|avi|wmv|flv)(\?.*)?$/i.test(t)?"direct":"other"},Fe=t=>{if(!t)return null;switch(Ne(t)){case"youtube":{const r=Pe(t);return r?`https://www.youtube.com/embed/${r}`:null}case"vimeo":{const r=ze(t);return r?`https://player.vimeo.com/video/${r}`:null}case"google-drive":{const r=_e(t);return r?`https://drive.google.com/file/d/${r}/preview`:null}case"vk":return t;case"direct":case"other":return t;default:return t}},ce=Se({content:ke().min(1,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º").max(1e3,"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π")});function Ve({lessonId:t}){const{user:i}=ge(),r=oe(),{socket:m}=Oe(),[T,C]=L.useState(null),[$,g]=L.useState(null),[y,j]=L.useState(1),[D,I]=L.useState({isOpen:!1,commentId:null});L.useEffect(()=>{if(m)return m.emit("join-lesson",t),m.on("new-comment",()=>{r.invalidateQueries(["comments",t])}),()=>{m&&(m.emit("leave-lesson",t),m.off("new-comment"))}},[m,t,r]);const{data:O,isLoading:_}=P(["comments",t,y],async()=>(await E.get(`/comments/lesson/${t}?page=${y}&limit=10`)).data,{refetchOnWindowFocus:!1}),U=O?.data?.comments||[],S=O?.data?.pagination,{register:a,handleSubmit:v,reset:N,formState:{errors:d}}=ne({resolver:le(ce)}),{register:c,handleSubmit:x,reset:b,formState:{errors:A}}=ne({resolver:le(ce)}),{register:H,handleSubmit:se,reset:K,formState:{errors:X},setValue:te}=ne({resolver:le(ce)}),z=Q(async l=>(await E.post(`/comments/lesson/${t}`,l)).data,{onSuccess:()=>{r.invalidateQueries(["comments",t]),N(),C(null),b(),y!==1&&j(1)}}),Y=Q(async l=>{await E.delete(`/comments/${l}`)},{onSuccess:()=>{r.invalidateQueries(["comments",t])}}),w=Q(async l=>(await E.put(`/comments/${l.commentId}`,{content:l.content})).data,{onSuccess:()=>{r.invalidateQueries(["comments",t]),g(null),K()}}),B=l=>{z.mutate(l)},ae=(l,f)=>{z.mutate({...l,parentId:f})},Z=(l,f)=>{w.mutate({commentId:f,content:l.content})},re=l=>{g(l.id),te("content",l.content)},J=l=>{if(!i||l.userId!==i.id)return!1;const f=Date.now()-new Date(l.createdAt).getTime(),s=15*60*1e3;return f<=s},G=l=>i?l.userId===i.id||i.role===R.TEACHER||i.role===R.ADMIN:!1,W=l=>i?i.role===R.TEACHER||i.role===R.ADMIN||i.role===R.CURATOR:!1;return e.jsxs("div",{className:"card p-6 md:p-8 animate-fade-scale",style:{animationDelay:"0.4s"},children:[e.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-neutral-900 mb-6",children:"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –≤–æ–ø—Ä–æ—Å—ã"}),i?.role===R.STUDENT&&e.jsx("form",{onSubmit:v(B),className:"mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{...a("content"),placeholder:"–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–ª–∏ –≤–æ–ø—Ä–æ—Å...",className:"input-field resize-none",rows:3}),d.content&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.content.message})]}),e.jsx("button",{type:"submit",disabled:z.isLoading,className:"btn-primary px-6 py-3 h-fit disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:z.isLoading?e.jsx("span",{className:"animate-spin",children:"‚ü≥"}):e.jsx(me,{className:"h-5 w-5"})})]})}),_?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-primary-200 border-t-primary-500"}),e.jsx("p",{className:"mt-4 text-neutral-600",children:"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤..."})]}):U.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"mx-auto h-12 w-12 text-neutral-400 mb-4"}),e.jsx("p",{className:"text-neutral-600",children:"–ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤"}),e.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π!"})]}):e.jsxs("div",{className:"space-y-4",children:[U.map(l=>e.jsxs("div",{className:"border border-neutral-200 rounded-lg p-4 bg-white animate-slide-in hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-gradient-primary text-white flex items-center justify-center font-bold",children:l.user?.firstName?.[0]||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-semibold text-neutral-900",children:[l.user?.firstName," ",l.user?.lastName]}),(l.user?.role===R.TEACHER||l.user?.role===R.ADMIN||l.user?.role===R.CURATOR)&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-primary-100 text-primary-700 border border-primary-200 font-medium",children:"–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å"})]}),$===l.id?e.jsxs("form",{onSubmit:se(f=>Z(f,l.id)),className:"mb-2",children:[e.jsx("textarea",{...H("content"),className:"input-field text-sm resize-none",rows:3}),X.content&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:X.content.message}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{type:"submit",disabled:w.isLoading,className:"btn-primary px-3 py-1 text-sm disabled:opacity-50",children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"}),e.jsx("button",{type:"button",onClick:()=>{g(null),K()},className:"btn-secondary px-3 py-1 text-sm",children:"–û—Ç–º–µ–Ω–∞"})]})]}):e.jsx("p",{className:"text-neutral-700 text-sm mb-2 whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:xe.sanitize(l.content,{ALLOWED_TAGS:[]})}}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-neutral-500",children:[e.jsx("span",{children:new Date(l.createdAt).toLocaleString("ru-RU")}),J(l)&&$!==l.id&&e.jsxs("button",{onClick:()=>re(l),className:"text-primary-600 hover:text-primary-700 transition-colors flex items-center gap-1",children:[e.jsx(ve,{size:14}),e.jsx("span",{children:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"})]}),W()&&e.jsxs("button",{onClick:()=>C(T===l.id?null:l.id),className:"text-primary-600 hover:text-primary-700 transition-colors flex items-center gap-1",children:[e.jsx(we,{size:14}),e.jsx("span",{children:"–û—Ç–≤–µ—Ç–∏—Ç—å"})]}),G(l)&&e.jsxs("button",{onClick:()=>I({isOpen:!0,commentId:l.id}),className:"text-red-600 hover:text-red-700 transition-colors flex items-center gap-1",children:[e.jsx(de,{size:14}),e.jsx("span",{children:"–£–¥–∞–ª–∏—Ç—å"})]})]})]})]}),T===l.id&&W()&&e.jsxs("form",{onSubmit:x(f=>ae(f,l.id)),className:"mt-3 ml-12 md:ml-14 border-l-2 border-primary-300 pl-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{...c("content"),placeholder:"–û—Ç–≤–µ—Ç–∏—Ç—å...",className:"input-field flex-1 text-sm resize-none",rows:2}),e.jsx("button",{type:"submit",disabled:z.isLoading,className:"btn-primary px-4 py-2 h-fit disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:z.isLoading?e.jsx("span",{className:"animate-spin",children:"‚ü≥"}):e.jsx(me,{className:"h-4 w-4"})})]}),A.content&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:A.content.message})]}),l.replies&&l.replies.length>0&&e.jsx("div",{className:"mt-3 ml-12 md:ml-14 space-y-3 border-l-2 border-primary-200 pl-4",children:l.replies.map(f=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-primary text-white flex items-center justify-center font-bold text-sm",children:f.user?.firstName?.[0]||"T"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"font-semibold text-neutral-900 text-sm",children:[f.user?.firstName," ",f.user?.lastName]}),(f.user?.role===R.TEACHER||f.user?.role===R.ADMIN||f.user?.role===R.CURATOR)&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded-full bg-primary-100 text-primary-700 border border-primary-200 font-medium",children:"–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å"})]}),e.jsx("p",{className:"text-neutral-700 text-sm mb-1 whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:xe.sanitize(f.content,{ALLOWED_TAGS:[]})}}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-neutral-500",children:[e.jsx("span",{children:new Date(f.createdAt).toLocaleString("ru-RU")}),G(f)&&e.jsxs("button",{onClick:()=>I({isOpen:!0,commentId:f.id}),className:"text-red-600 hover:text-red-700 transition-colors flex items-center gap-1",children:[e.jsx(de,{size:12}),e.jsx("span",{children:"–£–¥–∞–ª–∏—Ç—å"})]})]})]})]},f.id))})]},l.id)),S&&S.totalPages>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-6 pt-6 border-t border-neutral-200 gap-4",children:[e.jsxs("div",{className:"text-sm text-neutral-600",children:["–ü–æ–∫–∞–∑–∞–Ω–æ ",(S.page-1)*S.limit+1,"-",Math.min(S.page*S.limit,S.total)," –∏–∑ ",S.total," –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>j(y-1),disabled:y===1,className:"btn-secondary px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all",title:"–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",children:[e.jsx(Ce,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"–ù–∞–∑–∞–¥"})]}),e.jsxs("div",{className:"flex items-center gap-1 px-3 py-2 bg-primary-50 rounded-lg border border-primary-200",children:[e.jsx("span",{className:"text-sm font-semibold text-primary-700",children:S.page}),e.jsx("span",{className:"text-sm text-primary-500",children:"/"}),e.jsx("span",{className:"text-sm text-primary-600",children:S.totalPages})]}),e.jsxs("button",{onClick:()=>j(y+1),disabled:!S.hasMore,className:"btn-secondary px-4 py-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-all",title:"–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞",children:[e.jsx("span",{className:"hidden sm:inline",children:"–í–ø–µ—Ä–µ–¥"}),e.jsx(fe,{size:16})]})]})]})]}),e.jsx(je,{isOpen:D.isOpen,onClose:()=>I({isOpen:!1,commentId:null}),onConfirm:()=>{D.commentId&&Y.mutate(D.commentId)},title:"–£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π",message:"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.",confirmText:"–£–¥–∞–ª–∏—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",variant:"danger"})]})}function Qe({question:t,onAnswer:i,showResult:r,correctAnswer:m}){const[T,C]=L.useState([]),[$,g]=L.useState([]),[y,j]=L.useState([]),[D,I]=L.useState({});L.useEffect(()=>{if(t.metadata){const d=JSON.parse(t.metadata);t.type==="DRAG_DROP"?(C([...d.items]),g(d.targets.map(()=>null))):t.type==="MATCHING"&&j(d.leftItems.map(c=>({left:c,right:null})))}},[t]);const O=(d,c)=>{d.dataTransfer.setData("text/plain",c)},_=(d,c)=>{d.preventDefault();const x=d.dataTransfer.getData("text/plain"),b=[...$];b[c]=x,g(b),C(T.filter(A=>A!==x)),i(b)},U=d=>{d.preventDefault()},S=(d,c)=>{const x=[...y];x[d].right=c,j(x),i(x)},a=(d,c)=>{I({...D,[d]:c}),i(D)},v=()=>{if(t.metadata){const d=JSON.parse(t.metadata);C([...d.items]),g(d.targets.map(()=>null))}},N=()=>{if(t.metadata){const d=JSON.parse(t.metadata);j(d.leftItems.map(c=>({left:c,right:null})))}};if(t.type==="DRAG_DROP"){const d=t.metadata?JSON.parse(t.metadata):null;return d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:t.question}),e.jsxs("button",{onClick:v,className:"text-sm text-primary-600 hover:text-primary-700 mb-4 flex items-center gap-1",children:[e.jsx(ue,{className:"h-4 w-4"}),"–°–±—Ä–æ—Å–∏—Ç—å"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-3",children:"–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã:"}),e.jsx("div",{className:"space-y-2",children:T.map((c,x)=>e.jsx("div",{draggable:!0,onDragStart:b=>O(b,c),className:"p-3 bg-primary-100 text-primary-900 rounded-lg cursor-move hover:bg-primary-200 transition-colors",children:c},x))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-3",children:"–¶–µ–ª–µ–≤—ã–µ –æ–±–ª–∞—Å—Ç–∏:"}),e.jsx("div",{className:"space-y-2",children:d.targets.map((c,x)=>e.jsx("div",{onDrop:b=>_(b,x),onDragOver:U,className:`p-3 border-2 border-dashed rounded-lg min-h-[50px] flex items-center ${$[x]?"border-primary-500 bg-primary-50":"border-neutral-300"}`,children:$[x]?e.jsx("span",{className:"text-primary-900 font-medium",children:$[x]}):e.jsx("span",{className:"text-neutral-400",children:c})},x))})]})]}),r&&m&&e.jsx("div",{className:"mt-4 p-4 rounded-lg bg-neutral-50",children:e.jsxs("p",{className:"text-sm text-neutral-600",children:["–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ",JSON.stringify(m)]})})]}):null}if(t.type==="MATCHING"){const d=t.metadata?JSON.parse(t.metadata):null;return d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:t.question}),e.jsxs("button",{onClick:N,className:"text-sm text-primary-600 hover:text-primary-700 mb-4 flex items-center gap-1",children:[e.jsx(ue,{className:"h-4 w-4"}),"–°–±—Ä–æ—Å–∏—Ç—å"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-3",children:"–õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞:"}),e.jsx("div",{className:"space-y-2",children:y.map((c,x)=>e.jsx("div",{className:`p-3 rounded-lg border-2 ${c.right?"border-primary-500 bg-primary-50":"border-neutral-300 bg-neutral-50"}`,children:c.left},x))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-3",children:"–ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞:"}),e.jsx("div",{className:"space-y-2",children:d.rightItems.map((c,x)=>{const b=y.some(A=>A.right===c);return e.jsx("button",{onClick:()=>{const A=y.findIndex(H=>!H.right);A!==-1&&!b&&S(A,c)},disabled:b,className:`w-full p-3 rounded-lg border-2 text-left transition-colors ${b?"border-primary-500 bg-primary-50 cursor-not-allowed":"border-neutral-300 hover:border-primary-300 hover:bg-primary-50"}`,children:c},x)})})]})]}),r&&m&&e.jsx("div",{className:"mt-4 p-4 rounded-lg bg-neutral-50",children:e.jsxs("p",{className:"text-sm text-neutral-600",children:["–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä—ã: ",JSON.stringify(m)]})})]}):null}if(t.type==="FILL_BLANK"){const d=t.metadata?JSON.parse(t.metadata):null;if(!d)return null;const c=d.text.split("___");return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:t.question}),e.jsx("div",{className:"p-4 bg-neutral-50 rounded-lg",children:c.map((x,b)=>e.jsxs("span",{children:[x,b<c.length-1&&e.jsx("input",{type:"text",value:D[b]||"",onChange:A=>a(b,A.target.value),className:"inline-block mx-2 px-2 py-1 border-2 border-primary-300 rounded focus:outline-none focus:border-primary-500 min-w-[100px]",placeholder:"..."})]},b))}),r&&m&&e.jsx("div",{className:"mt-4 p-4 rounded-lg bg-neutral-50",children:e.jsxs("p",{className:"text-sm text-neutral-600",children:["–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ",JSON.stringify(m)]})})]})}return null}function He({lessonId:t,onComplete:i}){const r=oe(),[m,T]=L.useState({}),[C,$]=L.useState(!1),[g,y]=L.useState(null),{data:j,isLoading:D}=P(["quiz",t],async()=>(await E.get(`/quizzes/lesson/${t}`)).data.data,{enabled:!!t}),I=Q(async a=>(await E.post(`/quizzes/lesson/${t}/submit`,{answers:a})).data.data,{onSuccess:a=>{y(a),$(!0),r.invalidateQueries(["quiz",t]),i&&i(a)}}),O=(a,v)=>{T(N=>({...N,[a]:typeof v=="string"?v:JSON.stringify(v)}))},_=()=>{if(j&&Object.keys(m).length===j.questions.length){const a={};Object.keys(m).forEach(v=>{a[v]=m[v]}),I.mutate(a)}};if(D)return e.jsxs("div",{className:"card p-6 text-center",children:[e.jsx(pe,{className:"h-8 w-8 animate-spin text-primary-500 mx-auto mb-4"}),e.jsx("p",{className:"text-neutral-600",children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–∞..."})]});if(!j)return null;const U=Object.keys(m).length===j.questions.length,S=U&&!C&&!I.isLoading;return e.jsxs("div",{className:"card p-6 md:p-8 animate-fade-scale",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-gradient mb-2",children:j.title||"–¢–µ—Å—Ç –ø–æ —É—Ä–æ–∫—É"}),j.description&&e.jsx("p",{className:"text-neutral-600 mb-4",children:j.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-neutral-500",children:[e.jsxs("span",{children:["–í–æ–ø—Ä–æ—Å–æ–≤: ",j.questions.length]}),e.jsxs("span",{children:["–ü—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª: ",j.passingScore,"%"]})]})]}),C&&g?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`p-6 rounded-lg border-2 ${g.passed?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.passed?e.jsx(V,{className:"h-8 w-8 text-green-600"}):e.jsx(ie,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-xl font-bold ${g.passed?"text-green-700":"text-red-700"}`,children:g.passed?"–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω!":"–¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω"}),e.jsxs("p",{className:`text-sm ${g.passed?"text-green-600":"text-red-600"}`,children:["–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ",g.score,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-600",children:"–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤:"}),e.jsxs("span",{className:"font-semibold",children:[g.correctAnswers," –∏–∑ ",g.totalQuestions]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-neutral-600",children:"–ü—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª:"}),e.jsxs("span",{className:"font-semibold",children:[g.passingScore,"%"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:"}),j.questions.map((a,v)=>{const N=m[a.id],d=a.type==="MULTIPLE_CHOICE"?a.options?.find(c=>c.id===N)?.isCorrect:N===a.correctAnswer;return e.jsx("div",{className:`p-4 rounded-lg border-2 ${d?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[d?e.jsx(V,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}):e.jsx(ie,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-semibold text-neutral-900 mb-2",children:[v+1,". ",a.question]}),a.type==="MULTIPLE_CHOICE"&&a.options&&e.jsx("div",{className:"space-y-2",children:a.options.map(c=>{const x=c.id===N,b=c.isCorrect;return e.jsx("div",{className:`p-2 rounded ${b?"bg-green-100 border-2 border-green-300":x?"bg-red-100 border-2 border-red-300":"bg-neutral-50 border border-neutral-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[b&&e.jsx(V,{className:"h-4 w-4 text-green-600"}),x&&!b&&e.jsx(ie,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:b?"font-semibold text-green-700":x?"text-red-700":"text-neutral-700",children:c.text})]})},c.id)})}),a.type==="TRUE_FALSE"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`p-2 rounded ${a.correctAnswer==="true"?"bg-green-100 border-2 border-green-300":"bg-neutral-50 border border-neutral-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.correctAnswer==="true"&&e.jsx(V,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:a.correctAnswer==="true"?"font-semibold text-green-700":"text-neutral-700",children:"–í–µ—Ä–Ω–æ"})]})}),e.jsx("div",{className:`p-2 rounded ${a.correctAnswer==="false"?"bg-green-100 border-2 border-green-300":"bg-neutral-50 border border-neutral-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.correctAnswer==="false"&&e.jsx(V,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:a.correctAnswer==="false"?"font-semibold text-green-700":"text-neutral-700",children:"–ù–µ–≤–µ—Ä–Ω–æ"})]})})]})]})]})},a.id)})]})]}):e.jsxs("div",{className:"space-y-6",children:[j.questions.map((a,v)=>e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-gradient-primary text-white font-semibold flex-shrink-0",children:v+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-neutral-900 mb-3",children:a.question}),a.type==="MULTIPLE_CHOICE"&&a.options&&e.jsx("div",{className:"space-y-2",children:a.options.map(N=>e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${m[a.id]===N.id?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-primary-300 hover:bg-neutral-50"}`,children:[e.jsx("input",{type:"radio",name:a.id,value:N.id,checked:m[a.id]===N.id,onChange:()=>O(a.id,N.id),className:"w-4 h-4 text-primary-500 focus:ring-primary-500"}),e.jsx("span",{className:"text-neutral-700",children:N.text})]},N.id))}),a.type==="TRUE_FALSE"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${m[a.id]==="true"?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-primary-300 hover:bg-neutral-50"}`,children:[e.jsx("input",{type:"radio",name:a.id,value:"true",checked:m[a.id]==="true",onChange:()=>O(a.id,"true"),className:"w-4 h-4 text-primary-500 focus:ring-primary-500"}),e.jsx("span",{className:"text-neutral-700",children:"–í–µ—Ä–Ω–æ"})]}),e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${m[a.id]==="false"?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-primary-300 hover:bg-neutral-50"}`,children:[e.jsx("input",{type:"radio",name:a.id,value:"false",checked:m[a.id]==="false",onChange:()=>O(a.id,"false"),className:"w-4 h-4 text-primary-500 focus:ring-primary-500"}),e.jsx("span",{className:"text-neutral-700",children:"–ù–µ–≤–µ—Ä–Ω–æ"})]})]}),(a.type==="DRAG_DROP"||a.type==="MATCHING"||a.type==="FILL_BLANK")&&e.jsx(Qe,{question:a,onAnswer:N=>O(a.id,N),showResult:C,correctAnswer:a.correctAnswer?JSON.parse(a.correctAnswer):void 0})]})]})},a.id)),e.jsxs("div",{className:"pt-4 border-t border-neutral-200",children:[!U&&e.jsxs("div",{className:"flex items-center gap-2 text-amber-600 mb-4",children:[e.jsx(Ee,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∞"})]}),e.jsx("button",{onClick:_,disabled:!S,className:"btn-primary w-full md:w-auto disabled:opacity-50 disabled:cursor-not-allowed",children:I.isLoading?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"–û—Ç–ø—Ä–∞–≤–∫–∞..."})]}):"–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç"})]})]})]})}function We(){const{t}=Le(),{courseId:i,lessonId:r}=Re(),m=$e(),T=oe(),{user:C}=ge(),[$,g]=L.useState({isOpen:!1,fileId:null}),[y,j]=L.useState(new Set),[D,I]=L.useState(null),{data:O,isLoading:_}=P(["lesson",r],async()=>(await E.get(`/lessons/${r}`)).data.data),{data:U}=P(["course",i],async()=>(await E.get(`/courses/${i}`)).data.data,{enabled:!!i}),{data:S}=P(["modules",i],async()=>(await E.get(`/modules/courses/${i}/modules`)).data.data||[],{enabled:!!i}),{data:a}=P(["courseLessons",i],async()=>(await E.get(`/courses/${i}/lessons`)).data.data||[],{enabled:!!i}),{data:v}=P(["practiceExercises",r],async()=>{try{return(await E.get(`/practice/lessons/${r}`)).data.data||[]}catch{return[]}},{enabled:!!r}),{data:N}=P(["flashcardDecks",r],async()=>{try{return(await E.get("/flashcards",{params:{lessonId:r}})).data.data||[]}catch{return[]}},{enabled:!!r}),{data:d}=P(["integrations",r],async()=>{try{return(await E.get("/integrations",{params:{lessonId:r}})).data.data||[]}catch{return[]}},{enabled:!!r}),c=Q(async s=>(await E.put(`/lessons/${r}/progress`,s)).data,{onSuccess:()=>{T.invalidateQueries(["lesson",r]),T.invalidateQueries(["courseLessons",i])}}),x=Q(async s=>{try{await E.post(`/lessons/${r}/feedback`,{rating:s})}catch{console.log("Feedback endpoint not implemented yet")}},{onSuccess:()=>{}}),b=Q(async s=>{await E.delete(`/files/${s}`)},{onSuccess:()=>{T.invalidateQueries(["lesson",r]),g({isOpen:!1,fileId:null})}}),A=s=>C?C.role===R.TEACHER||C.role===R.ADMIN||C.role===R.CURATOR:!1,H=async(s,p,h)=>{s.preventDefault(),s.stopPropagation(),s.nativeEvent&&s.nativeEvent.stopImmediatePropagation();try{let u=h;try{if(/[ƒê√ë‚Ç¨√ê¬£]/.test(h)){const n=new Uint8Array(h.length);for(let o=0;o<h.length;o++)n[o]=h.charCodeAt(o)&255;u=new TextDecoder("utf-8",{fatal:!1}).decode(n),/[ƒê√ë‚Ç¨√ê¬£]/.test(u)&&(u=decodeURIComponent(escape(h)))}else if(h.includes("%"))try{u=decodeURIComponent(h)}catch{u=h}}catch{u=h}if(p.includes("supabase.co")||p.includes("cloudinary.com")||p.startsWith("http")&&!p.includes("/api/files/"))try{const n=await fetch(p,{mode:"cors"});if(!n.ok)throw new Error("Failed to fetch file");const o=await n.blob(),M=window.URL.createObjectURL(o),k=document.createElement("a");k.href=M,k.download=u,k.style.display="none",document.body.appendChild(k),k.click(),setTimeout(()=>{document.body.contains(k)&&document.body.removeChild(k),window.URL.revokeObjectURL(M)},100)}catch(n){console.error("Error fetching cloud file:",n);const o=document.createElement("a");o.href=p,o.download=u,o.target="_blank",o.rel="noopener noreferrer",o.style.display="none",document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o)},100)}else{const n=p.replace("/api/files/download/",""),o=await E.get(`/files/download/${n}`,{responseType:"blob"}),M=new Blob([o.data]),k=window.URL.createObjectURL(M),F=document.createElement("a");F.href=k,F.download=u,F.style.display="none",document.body.appendChild(F),F.click(),setTimeout(()=>{document.body.contains(F)&&document.body.removeChild(F),window.URL.revokeObjectURL(k)},100)}}catch(u){console.error("Error downloading file:",u);try{const n=document.createElement("a");n.href=p,n.target="_blank",n.rel="noopener noreferrer",n.style.display="none",document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.contains(n)&&document.body.removeChild(n)},100)}catch(n){console.error("Fallback download also failed:",n)}}return!1},se=s=>{c.mutate({lastPosition:Math.floor(s.playedSeconds)})},K=()=>{c.mutate({completed:!0})},X=s=>{const p=new Set(y);p.has(s)?p.delete(s):p.add(s),j(p)},te=s=>{I(s),x.mutate(s)},z=()=>{const s=a||[],p=S||[],h=new Map,u=[];return s.forEach(n=>{n.moduleId?(h.has(n.moduleId)||h.set(n.moduleId,[]),h.get(n.moduleId).push(n)):u.push(n)}),h.forEach(n=>{n.sort((o,M)=>o.order-M.order)}),{lessonsByModule:h,lessonsWithoutModule:u,modules:p.sort((n,o)=>n.order-o.order)}},Y=s=>{if(!C||C.role!=="STUDENT"||s.progress?.completed)return!0;const h=[...a||[]].sort((n,o)=>n.order-o.order),u=h.findIndex(n=>n.id===s.id);return u===0?!0:u>0&&h[u-1].progress?.completed||!1};if(_)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block relative",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary-200 border-t-primary-500"})}),e.jsx("p",{className:"mt-4 text-neutral-600",children:t("common.loading")})]});const w=O;if(!w)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-neutral-600",children:t("errors.notFound")})});const B=U,{lessonsByModule:ae,lessonsWithoutModule:Z,modules:re}=z(),J=a||[],G=J.findIndex(s=>s.id===r),W=G<J.length-1?J[G+1]:null,l=w.videoUrl?Fe(w.videoUrl):null,f=w.videoUrl?Ne(w.videoUrl):null;return L.useEffect(()=>{w.moduleId&&!y.has(w.moduleId)&&j(new Set([...y,w.moduleId]))},[w.moduleId,y]),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>m(`/courses/${i}`),className:"flex items-center text-neutral-600 hover:text-primary-600 mb-4 transition-colors group",children:[e.jsx(Ae,{className:"h-5 w-5 mr-2 group-hover:-translate-x-1 transition-transform"}),"–ù–∞–∑–∞–¥"]}),e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-4xl font-bold text-neutral-900 mb-3 break-words",children:w.title}),B?.category&&e.jsx("div",{className:"mb-6",children:e.jsx("span",{className:`inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium ${Ue(B.category)}`,children:Me(B.category)})})]}),l&&e.jsx("div",{className:"w-full bg-neutral-900 rounded-lg overflow-hidden shadow-lg",children:e.jsx("div",{className:"aspect-video",children:f==="google-drive"?e.jsx("iframe",{src:l||"",width:"100%",height:"100%",allow:"autoplay",style:{border:"none"},allowFullScreen:!0}):e.jsx(Te,{url:w.videoUrl||"",width:"100%",height:"100%",controls:!0,onProgress:se,onEnded:K,config:{youtube:{playerVars:{start:w.progress?.lastPosition||0}},vimeo:{playerOptions:{start:w.progress?.lastPosition||0}}}})})}),e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"–ö–∞–∫ –ø—Ä–æ—à–µ–ª —É—Ä–æ–∫?"}),e.jsx("p",{className:"text-sm text-neutral-600 mb-4",children:"–ù–∞–º –≤–∞–∂–Ω–∞ –í–∞—à–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å"}),e.jsx("div",{className:"flex items-center justify-center gap-4",children:[1,2,3,4,5].map(s=>e.jsxs("button",{onClick:()=>te(s),className:`text-4xl transition-transform hover:scale-110 ${D===s?"scale-110":"opacity-70 hover:opacity-100"}`,disabled:x.isLoading,children:[s===1&&"üò¢",s===2&&"üòï",s===3&&"üòê",s===4&&"üôÇ",s===5&&"üòÑ"]},s))})]}),w.files&&w.files.length>0&&e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-neutral-900 mb-4",children:t("lessons.files",{defaultValue:"–§–∞–π–ª—ã —É—Ä–æ–∫–∞"})}),e.jsx("div",{className:"space-y-3",children:w.files.map(s=>{const p=/\.(mp4|webm|mov|avi|wmv|flv|mpeg)$/i.test(s.fileName),h=/\.(pdf|doc|docx|xls|xlsx|ppt|pptx|txt)$/i.test(s.fileName),u=/\.(jpg|jpeg|png|gif|webp)$/i.test(s.fileName);return e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 p-3 md:p-4 border border-neutral-200 rounded-lg hover:bg-neutral-50 hover:border-primary-300 transition-all group",children:[e.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 mr-3",children:h?e.jsx(q,{className:"h-5 w-5 text-blue-500"}):p?e.jsx(he,{className:"h-5 w-5 text-purple-500"}):u?e.jsx(q,{className:"h-5 w-5 text-green-500"}):e.jsx(q,{className:"h-5 w-5 text-primary-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-neutral-900 truncate",title:s.fileName,children:(()=>{try{const n=s.fileName;if(/[ƒê√ë‚Ç¨√ê¬£]/.test(n)){const o=new Uint8Array(n.length);for(let k=0;k<n.length;k++)o[k]=n.charCodeAt(k)&255;const M=new TextDecoder("utf-8",{fatal:!1}).decode(o);return/[ƒê√ë‚Ç¨√ê¬£]/.test(M)?decodeURIComponent(escape(n)):M}return n}catch{return s.fileName}})()}),e.jsxs("p",{className:"text-sm text-neutral-500",children:[t("lessons.fileSize",{defaultValue:"–†–∞–∑–º–µ—Ä"}),": ",(s.fileSize/1024/1024).toFixed(2)," MB"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),H(n,s.fileUrl,s.fileName)},className:"btn-secondary px-4 py-2 text-sm flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),p?"–°–º–æ—Ç—Ä–µ—Ç—å":"–°–∫–∞—á–∞—Ç—å"]}),A()&&e.jsxs("button",{type:"button",onClick:n=>{n.preventDefault(),n.stopPropagation(),g({isOpen:!0,fileId:s.id})},className:"px-3 py-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-lg transition-colors flex items-center gap-2",title:"–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"–£–¥–∞–ª–∏—Ç—å"})]})]})]},s.id)})})]}),v&&v.length>0&&e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-neutral-900 mb-6",children:t("practice.title")}),e.jsx("div",{className:"space-y-6",children:v.map(s=>e.jsxs("div",{className:"p-4 border border-neutral-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:s.title}),s.description&&e.jsx("p",{className:"text-neutral-600 mb-4",children:s.description}),e.jsx(ee,{to:`/lessons/${r}/practice`,className:"btn-primary text-sm",children:t("practice.execute",{defaultValue:"–í—ã–ø–æ–ª–Ω–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ"})})]},s.id))})]}),N&&N.length>0&&e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-neutral-900 mb-4",children:t("flashcards.title")}),e.jsx("div",{className:"space-y-4",children:N.map(s=>e.jsxs("div",{className:"p-4 border border-neutral-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:s.title}),s.description&&e.jsx("p",{className:"text-neutral-600 mb-4 text-sm",children:s.description}),e.jsx(ee,{to:`/flashcards/${s.id}/study`,className:"btn-primary text-sm",children:t("flashcards.study")})]},s.id))})]}),e.jsx("div",{children:e.jsx(He,{lessonId:r,onComplete:s=>{s.passed&&T.invalidateQueries(["lesson",r])}})}),e.jsx(Ve,{lessonId:r}),W&&e.jsxs("button",{onClick:()=>m(`/courses/${i}/lessons/${W.id}`),className:"w-full bg-neutral-800 hover:bg-neutral-900 text-white font-semibold py-4 px-6 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx("span",{children:"–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫"}),e.jsx(fe,{className:"h-5 w-5"})]})]}),e.jsx("div",{className:"w-full lg:w-80 flex-shrink-0",children:e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-lg shadow-sm sticky top-6",children:[e.jsx("div",{className:"p-4 border-b border-neutral-200",children:e.jsx("h3",{className:"font-semibold text-neutral-900",children:"–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∫—É—Ä—Å–∞"})}),e.jsxs("div",{className:"p-2 max-h-[calc(100vh-200px)] overflow-y-auto",children:[re.map(s=>{const p=ae.get(s.id)||[],h=y.has(s.id);return e.jsxs("div",{className:"mb-2",children:[e.jsxs("button",{onClick:()=>X(s.id),className:"w-full flex items-center justify-between p-3 hover:bg-neutral-50 rounded-lg transition-colors text-left",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(he,{className:"h-5 w-5 text-primary-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-neutral-900 truncate",children:s.title}),e.jsxs("div",{className:"text-xs text-neutral-500",children:[p.length," —É—Ä–æ–∫–æ–≤"]})]})]}),h?e.jsx(De,{className:"h-5 w-5 text-neutral-400 flex-shrink-0"}):e.jsx(Ie,{className:"h-5 w-5 text-neutral-400 flex-shrink-0"})]}),h&&e.jsx("div",{className:"ml-4 mt-1 space-y-1",children:p.map((u,n)=>{const o=u.id===r,M=Y(u),k=u.progress?.completed||!1;return e.jsxs(ee,{to:`/courses/${i}/lessons/${u.id}`,className:`flex items-center justify-between p-2 rounded-lg transition-colors ${o?"bg-primary-50 border-l-4 border-primary-600":"hover:bg-neutral-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsxs("span",{className:"text-sm text-neutral-500 flex-shrink-0",children:[String(n+1).padStart(2,"0"),"."]}),e.jsx("span",{className:`text-sm truncate ${o?"font-semibold text-primary-700":"text-neutral-700"}`,children:u.title})]}),e.jsx("div",{className:"flex-shrink-0 ml-2",children:M?e.jsx(V,{className:`h-4 w-4 ${k?"text-green-500":"text-neutral-400"}`}):e.jsx(be,{className:"h-4 w-4 text-neutral-300"})})]},u.id)})})]},s.id)}),Z.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-500 mb-2 px-3",children:"–ë–µ–∑ –º–æ–¥—É–ª—è"}),e.jsx("div",{className:"space-y-1",children:Z.map(s=>{const p=s.id===r,h=Y(s),u=s.progress?.completed||!1;return e.jsxs(ee,{to:`/courses/${i}/lessons/${s.id}`,className:`flex items-center justify-between p-2 rounded-lg transition-colors ${p?"bg-primary-50 border-l-4 border-primary-600":"hover:bg-neutral-50"}`,children:[e.jsx("span",{className:`text-sm truncate ${p?"font-semibold text-primary-700":"text-neutral-700"}`,children:s.title}),e.jsx("div",{className:"flex-shrink-0 ml-2",children:h?e.jsx(V,{className:`h-4 w-4 ${u?"text-green-500":"text-neutral-400"}`}):e.jsx(be,{className:"h-4 w-4 text-neutral-300"})})]},s.id)})})]})]})]})}),e.jsx(je,{isOpen:$.isOpen,onClose:()=>g({isOpen:!1,fileId:null}),onConfirm:()=>{$.fileId&&b.mutate($.fileId)},title:"–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª",message:"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.",confirmText:"–£–¥–∞–ª–∏—Ç—å",cancelText:"–û—Ç–º–µ–Ω–∞",variant:"danger"})]})}export{We as default};
