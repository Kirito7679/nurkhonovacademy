import{ae as O,d as $,u as A,r as l,e as b,f as D,j as e,ap as N,am as I,Z as L,W as F,ao as Q,D as T}from"./vendor-D-riqg-X.js";import{a as x}from"./index-BdrAEdvH.js";import{S as P}from"./SuccessModal-2VojkkiP.js";function W(){const{id:s}=O(),c=$(),h=A(),[a,u]=l.useState(0),[v,i]=l.useState(!1),[d,o]=l.useState(!1),[f,p]=l.useState({isOpen:!1,message:""}),{data:g,isLoading:y}=b(["flashcardDeck",s],async()=>(await x.get(`/flashcards/${s}`)).data.data,{enabled:!!s}),{data:w,isLoading:C}=b(["flashcardsToReview",s],async()=>(await x.get(`/flashcards/${s}/review`)).data.data||[],{enabled:!!s}),k=D(async({cardId:r,difficulty:E})=>{await x.put(`/flashcards/${s}/cards/${r}/progress`,{difficulty:E})},{onSuccess:()=>{h.invalidateQueries(["flashcardsToReview",s])}}),j=g,t=w||[],n=t[a],m=r=>{n&&(k.mutate({cardId:n.id,difficulty:r}),a<t.length-1?(u(a+1),i(!1),o(!1)):(p({isOpen:!0,message:"Все карточки изучены! Отличная работа!"}),setTimeout(()=>{c(`/flashcards/${s}`)},2e3)))},S=()=>{i(!v),o(!d)},R=()=>{u(0),i(!1),o(!1),h.invalidateQueries(["flashcardsToReview",s])};if(y||C)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block relative",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary-200 border-t-primary-500"})}),e.jsx("p",{className:"mt-4 text-neutral-600",children:"Загрузка карточек..."})]});if(!j||t.length===0)return e.jsxs("div",{className:"text-center py-12 animate-fade-scale",children:[e.jsx("p",{className:"text-neutral-500 mb-4",children:"Нет карточек для изучения"}),e.jsxs("button",{onClick:()=>c("/flashcards"),className:"btn-primary",children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),"Назад к колодам"]})]});const M=(a+1)/t.length*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>c("/flashcards"),className:"flex items-center text-neutral-600 hover:text-primary-600 transition-colors",children:[e.jsx(N,{className:"h-5 w-5 mr-2"}),"Назад"]}),e.jsxs("button",{onClick:R,className:"flex items-center text-neutral-600 hover:text-primary-600 transition-colors",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Начать заново"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-neutral-900 mb-2",children:j.title}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-neutral-600",children:["Карточка ",a+1," из ",t.length]}),e.jsx("div",{className:"w-32 bg-neutral-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded-full transition-all",style:{width:`${M}%`}})})]})]}),e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("div",{className:"card p-8 md:p-12 min-h-[400px] flex items-center justify-center cursor-pointer transform transition-transform hover:scale-105",onClick:S,children:e.jsx("div",{className:"text-center w-full",children:d?e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx(F,{className:"h-6 w-6 text-primary-500"})}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-neutral-900 mb-4",children:n.back}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Нажмите, чтобы вернуться"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx(L,{className:"h-6 w-6 text-primary-500"})}),e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-neutral-900 mb-4",children:n.front}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Нажмите, чтобы увидеть ответ"})]})})}),d&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>m("HARD"),className:"btn-secondary text-red-600 hover:bg-red-50 border-red-200",children:[e.jsx(Q,{className:"h-5 w-5 mr-2"}),"Сложно"]}),e.jsx("button",{onClick:()=>m("MEDIUM"),className:"btn-secondary text-yellow-600 hover:bg-yellow-50 border-yellow-200",children:"Средне"}),e.jsxs("button",{onClick:()=>m("EASY"),className:"btn-secondary text-green-600 hover:bg-green-50 border-green-200",children:[e.jsx(T,{className:"h-5 w-5 mr-2"}),"Легко"]})]})]}),e.jsx(P,{isOpen:f.isOpen,onClose:()=>p({isOpen:!1,message:""}),message:f.message})]})}export{W as default};
