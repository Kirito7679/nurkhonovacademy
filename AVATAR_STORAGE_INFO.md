# üì∏ –ì–¥–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üìÅ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```
backend/uploads/
```

**–ü–æ–ª–Ω—ã–π –ø—É—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –∫–æ–¥–µ:**
- –§–∞–π–ª: `backend/src/services/fileService.ts`
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞: `UPLOAD_DIR = path.join(__dirname, '../../uploads')`
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç: `backend/src/../../uploads` = `backend/uploads/`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
backend/
  ‚îî‚îÄ‚îÄ uploads/
      ‚îú‚îÄ‚îÄ .gitkeep
      ‚îú‚îÄ‚îÄ 2025-12-12_13_11_24_6dbaa142-e304-4a67-b8dd-4dd7bfe278fd.jpg
      ‚îú‚îÄ‚îÄ 2025-12-12_13_11_24_dc3dbbed-da59-4527-b37e-32f7b9e92713.jpg
      ‚îî‚îÄ‚îÄ ... (–¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã)
```

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞:
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç**: `POST /api/auth/me/avatar`
- **Middleware**: `upload.single('avatar')` (Multer)
- **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä**: `uploadAvatar` –≤ `authController.ts`

### 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:
- Multer —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª –≤ `backend/uploads/` —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º
- –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏: `{sanitized_original_name}_{UUID}.{extension}`
- –ü—Ä–∏–º–µ—Ä: `2025-12-12_13_11_24_6dbaa142-e304-4a67-b8dd-4dd7bfe278fd.jpg`

### 3. –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É:
- **URL –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**: `/api/files/avatar/{filename}`
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è**: `GET /api/files/avatar/:fileName`
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø**: `GET /uploads/{filename}` (—á–µ—Ä–µ–∑ Express static)

### 4. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞:
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞ —Å—Ç–∞—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è
- –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ `uploadAvatar` —Ñ—É–Ω–∫—Ü–∏–∏

## üìã –ö–æ–¥:

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Multer (`fileController.ts`):
```typescript
const storage = multer.diskStorage({
  destination: async (req, file, cb) => {
    await ensureUploadDir();
    cb(null, path.join(__dirname, '../../uploads'));
  },
  filename: (req, file, cb) => {
    const fileName = generateFileName(file.originalname);
    cb(null, fileName);
  },
});
```

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (`app.ts`):
```typescript
// Serve uploaded files
app.use('/uploads', express.static('uploads'));
```

### –†–æ—É—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ (`fileRoutes.ts`):
```typescript
router.get('/avatar/:fileName', downloadAvatar);
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è Production (Railway):

### –ü—Ä–æ–±–ª–µ–º–∞:
- –ù–∞ Railway —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ **–≤—Ä–µ–º–µ–Ω–Ω—É—é —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ/–ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **—Ñ–∞–π–ª—ã —Ç–µ—Ä—è—é—Ç—Å—è**
- –≠—Ç–æ **ephemeral storage** - –Ω–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### –†–µ—à–µ–Ω–∏–µ:
–î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**:

1. **AWS S3** (Amazon Simple Storage Service)
2. **Cloudinary** (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
3. **Google Cloud Storage**
4. **Azure Blob Storage**

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚ö†Ô∏è **–ù–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è production** - —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω—ã
- üìù –ù—É–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

### –õ–æ–∫–∞–ª—å–Ω–æ:
```bash
cd backend
ls -la uploads/
```

### –ù–∞ Railway:
–§–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Ç–µ—Ä—è—é—Ç—Å—è.

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–î–ª—è production**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (S3/Cloudinary)
2. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
3. **–ë—ç–∫–∞–ø**: –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã

---

**–¢–µ–∫—É—â–∏–π –ø—É—Ç—å**: `backend/uploads/` (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è backend –ø—Ä–æ–µ–∫—Ç–∞)
