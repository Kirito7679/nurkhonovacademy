import{k as E,u as T,r as a,e as k,f as b,j as e,aO as S,aZ as x,T as U,Y as L,t as M,ai as Q}from"./vendor-BwEBtozQ.js";import{C as D,a as u}from"./index-_CiEywzY.js";import{E as G}from"./ErrorModal-D-tfKWNy.js";function Z(){const{t}=E(),p=T(),[h,n]=a.useState(!1),[g,v]=a.useState("QUIZLET"),[l,i]=a.useState(""),[r,o]=a.useState(""),[j,f]=a.useState({isOpen:!1,message:""}),[c,d]=a.useState({isOpen:!1,integrationId:null}),{data:y,isLoading:I}=k("integrations",async()=>(await u.get("/integrations")).data.data||[]),m=b(async s=>(await u.post("/integrations",s)).data.data,{onSuccess:()=>{p.invalidateQueries("integrations"),n(!1),i(""),o("")}}),O=b(async s=>{await u.delete(`/integrations/${s}`)},{onSuccess:()=>{p.invalidateQueries("integrations")}}),C=()=>{if(!l||!r){f({isOpen:!0,message:t("errors.fillAllFields",{defaultValue:"Заполните все поля"})});return}m.mutate({type:g,externalId:l,externalUrl:r})},w=s=>{switch(s){case"GOOGLE_DOCS":return e.jsx(Q,{className:"h-5 w-5"});case"QUIZLET":return e.jsx(M,{className:"h-5 w-5"});case"YOUTUBE":return e.jsx(L,{className:"h-5 w-5"});default:return e.jsx(x,{className:"h-5 w-5"})}},N=y||[];return I?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block relative",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary-200 border-t-primary-500"})}),e.jsx("p",{className:"mt-4 text-neutral-600",children:"Загрузка интеграций..."})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-5xl font-bold text-gradient",children:t("integrations.title")}),e.jsxs("button",{onClick:()=>n(!h),className:"btn-primary",children:[e.jsx(S,{className:"h-5 w-5 mr-2"}),t("integrations.addIntegration")]})]}),h&&e.jsxs("div",{className:"card p-6 mb-6 animate-fade-scale",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-900 mb-4",children:t("integrations.createIntegration",{defaultValue:"Создать интеграцию"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:t("integrations.integrationType")}),e.jsxs("select",{value:g,onChange:s=>v(s.target.value),className:"input-field",children:[e.jsx("option",{value:"QUIZLET",children:"Quizlet"}),e.jsx("option",{value:"GOOGLE_DOCS",children:"Google Docs"}),e.jsx("option",{value:"YOUTUBE",children:"YouTube"}),e.jsx("option",{value:"OTHER",children:t("integrations.other")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:t("integrations.externalId")}),e.jsx("input",{type:"text",value:l,onChange:s=>i(s.target.value),placeholder:t("integrations.externalIdPlaceholder",{defaultValue:"ID ресурса во внешнем сервисе"}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"URL"}),e.jsx("input",{type:"url",value:r,onChange:s=>o(s.target.value),placeholder:"https://...",className:"input-field"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:C,disabled:m.isLoading,className:"btn-primary disabled:opacity-50",children:m.isLoading?t("common.loading"):t("common.create")}),e.jsx("button",{onClick:()=>{n(!1),i(""),o("")},className:"btn-secondary",children:t("common.cancel")})]})]})]}),N.length===0?e.jsxs("div",{className:"text-center py-12 animate-fade-scale",children:[e.jsx(x,{className:"h-16 w-16 text-neutral-300 mx-auto mb-4"}),e.jsx("p",{className:"text-neutral-500",children:t("integrations.noIntegrations")})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(s=>e.jsxs("div",{className:"card p-6 hover:shadow-lg transition-all animate-fade-scale",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary-100 rounded-lg text-primary-600",children:w(s.type)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-neutral-900",children:s.type}),e.jsxs("p",{className:"text-xs text-neutral-500",children:["ID: ",s.externalId]})]})]}),e.jsx("button",{onClick:()=>{d({isOpen:!0,integrationId:s.id})},className:"text-red-500 hover:text-red-600",children:e.jsx(U,{className:"h-5 w-5"})})]}),e.jsxs("a",{href:s.externalUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-secondary w-full text-center flex items-center justify-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),t("integrations.open")]})]},s.id))}),e.jsx(G,{isOpen:j.isOpen,onClose:()=>f({isOpen:!1,message:""}),message:j.message}),e.jsx(D,{isOpen:c.isOpen,onClose:()=>d({isOpen:!1,integrationId:null}),onConfirm:()=>{c.integrationId&&(O.mutate(c.integrationId),d({isOpen:!1,integrationId:null}))},title:t("integrations.deleteIntegration",{defaultValue:"Удалить интеграцию"}),message:t("integrations.deleteConfirm",{defaultValue:"Удалить интеграцию?"}),variant:"danger"})]})}export{Z as default};
