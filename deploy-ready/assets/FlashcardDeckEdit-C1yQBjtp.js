import{a6 as D,u as M,a as O,r as c,b as L,d as y,j as e,ag as Q,ay as F,T as R,aC as T}from"./vendor-react-CYnsZ-uh.js";import{a as u}from"./index-B_lpl_ns.js";import{E as $}from"./ErrorModal-BhYSOHfb.js";import"./vendor-other-G1F3Ub8s.js";function _(){const{id:t}=D(),x=M(),h=O(),[d,p]=c.useState(""),[f,b]=c.useState(""),[j,v]=c.useState(!1),[n,i]=c.useState([]),[g,N]=c.useState({isOpen:!1,message:""}),{data:l,isLoading:C}=L(["flashcardDeck",t],async()=>(await u.get(`/flashcards/${t}`)).data.data,{enabled:!!t}),o=y(async s=>(await u.put(`/flashcards/${t}`,s)).data.data,{onSuccess:()=>{h.invalidateQueries(["flashcardDeck",t]),x("/flashcards")}}),w=y(async s=>(await u.post(`/flashcards/${t}/cards`,s)).data.data,{onSuccess:()=>{h.invalidateQueries(["flashcardDeck",t])}});c.useEffect(()=>{l&&(p(l.title),b(l.description||""),v(l.isPublic),l.flashcards&&i(l.flashcards.map(s=>({front:s.front,back:s.back}))))},[l]);const S=()=>{i([...n,{front:"",back:""}])},E=s=>{i(n.filter((a,r)=>r!==s))},k=(s,a,r)=>{const m=[...n];m[s]={...m[s],[a]:r},i(m)},P=()=>{if(!d.trim()){N({isOpen:!0,message:"Введите название колоды"});return}o.mutate({title:d,description:f||void 0,isPublic:j}),n.forEach(s=>{s.front.trim()&&s.back.trim()&&w.mutate(s)})};return C?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block relative",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary-200 border-t-primary-500"})}),e.jsx("p",{className:"mt-4 text-neutral-600",children:"Загрузка колоды..."})]}):e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>x("/flashcards"),className:"flex items-center text-neutral-600 hover:text-primary-600 mb-6 transition-colors",children:[e.jsx(Q,{className:"h-5 w-5 mr-2"}),"Назад"]}),e.jsx("h1",{className:"text-2xl md:text-3xl lg:text-5xl font-bold text-gradient mb-8",children:"Редактировать колоду"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"card p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Название колоды"}),e.jsx("input",{type:"text",value:d,onChange:s=>p(s.target.value),className:"input-field",placeholder:"Название колоды"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Описание"}),e.jsx("textarea",{value:f,onChange:s=>b(s.target.value),rows:3,className:"input-field",placeholder:"Описание колоды..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isPublic",checked:j,onChange:s=>v(s.target.checked),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"isPublic",className:"text-sm text-neutral-700",children:"Публичная колода"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-neutral-900",children:"Карточки"}),e.jsxs("button",{onClick:S,className:"btn-secondary text-sm",children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),"Добавить карточку"]})]}),e.jsx("div",{className:"space-y-4",children:n.map((s,a)=>e.jsxs("div",{className:"p-4 border border-neutral-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-medium text-neutral-700",children:["Карточка ",a+1]}),e.jsx("button",{onClick:()=>E(a),className:"text-red-500 hover:text-red-600",children:e.jsx(R,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:"Лицевая сторона"}),e.jsx("input",{type:"text",value:s.front,onChange:r=>k(a,"front",r.target.value),className:"input-field text-sm",placeholder:"Вопрос или слово"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-neutral-600 mb-1",children:"Обратная сторона"}),e.jsx("input",{type:"text",value:s.back,onChange:r=>k(a,"back",r.target.value),className:"input-field text-sm",placeholder:"Ответ или перевод"})]})]})]},a))})]}),e.jsxs("button",{onClick:P,disabled:o.isLoading,className:"btn-primary w-full disabled:opacity-50",children:[e.jsx(T,{className:"h-5 w-5 mr-2"}),o.isLoading?"Сохранение...":"Сохранить"]})]})})}),e.jsx($,{isOpen:g.isOpen,onClose:()=>N({isOpen:!1,message:""}),message:g.message})]})}export{_ as default};
