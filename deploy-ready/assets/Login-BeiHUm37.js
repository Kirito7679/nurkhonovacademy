import{k as g,d as w,r as n,V as N,j as e,L as v,W as S,Z as A,$ as E,a0 as k,a1 as h}from"./vendor-BvlDnYZi.js";import{u as L,L as R,a as T}from"./index-CAeYndoa.js";const C=/^(\+?998)?[0-9]{9}$/,$=k({phone:h().min(1,"Номер телефона обязателен").regex(C,"Неверный формат номера телефона"),password:h().min(1,"Пароль обязателен")});function H(){const{t:s}=g(),l=w(),{setAuth:x}=L(),[d,o]=n.useState(""),[c,m]=n.useState(!1),[i,u]=n.useState(!1),{register:p,handleSubmit:f,formState:{errors:a}}=N({resolver:E($)}),b=async y=>{o(""),m(!0);try{const t=await T.post("/auth/login",y);if(t.data.success&&t.data.data){const{user:r,token:j}=t.data.data;x(r,j),r.role==="TEACHER"||r.role==="ADMIN"||r.role==="CURATOR"?l("/teacher/dashboard"):l("/dashboard")}}catch(t){if(t.isRateLimit){const r=t.retryAfter||60;o(`Слишком много попыток входа. Пожалуйста, подождите ${r} секунд и попробуйте снова.`)}else t.isNetworkError?o("Ошибка сети. Проверьте подключение к интернету и попробуйте снова."):t.isTimeout?o("Превышено время ожидания. Попробуйте снова."):o(t.response?.data?.message||s("errors.somethingWentWrong"))}finally{m(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50/50 to-emerald-50 py-12 px-4 sm:px-6 lg:px-8 relative",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"relative inline-flex items-center justify-center mb-4",children:e.jsx(R,{className:"h-12 md:h-16"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gradient",children:s("auth.login")}),e.jsxs("p",{className:"mt-2 text-center text-sm text-primary-700",children:[s("auth.dontHaveAccount")," ",e.jsx(v,{to:"/register",className:"font-semibold text-primary-600 hover:text-primary-800 transition-colors underline decoration-2 underline-offset-2",children:s("auth.register")})]})]}),e.jsx("div",{className:"card p-8 shadow-education",children:e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:f(b),children:[d&&e.jsx("div",{className:"bg-red-50 border-2 border-red-300 text-red-800 px-4 py-3 rounded-lg font-medium",children:d}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-semibold text-primary-800 mb-2",children:s("auth.phone")}),e.jsx("input",{...p("phone"),id:"phone",type:"text",autoComplete:"tel",className:"input-field",placeholder:"+998901234567","aria-invalid":a.phone?"true":"false","aria-describedby":a.phone?"phone-error":void 0}),a.phone&&e.jsx("p",{id:"phone-error",className:"mt-1 text-sm text-red-600 font-medium",role:"alert",children:a.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-primary-800 mb-2",children:s("auth.password")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...p("password"),id:"password",type:i?"text":"password",autoComplete:"current-password",className:"input-field pr-12",placeholder:s("auth.password"),"aria-invalid":a.password?"true":"false","aria-describedby":a.password?"password-error":void 0}),e.jsx("button",{type:"button",onClick:()=>u(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-primary-400 hover:text-primary-600 transition-colors focus:outline-none","aria-label":i?"Скрыть пароль":"Показать пароль","aria-pressed":i,children:i?e.jsx(S,{className:"h-5 w-5"}):e.jsx(A,{className:"h-5 w-5"})})]}),a.password&&e.jsx("p",{id:"password-error",className:"mt-1 text-sm text-red-600 font-medium",role:"alert",children:a.password.message})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:c,className:"btn-primary w-full disabled:opacity-50 disabled:cursor-not-allowed text-base py-3.5",children:s(c?"common.loading":"auth.login")})})]})})]})})}export{H as default};
